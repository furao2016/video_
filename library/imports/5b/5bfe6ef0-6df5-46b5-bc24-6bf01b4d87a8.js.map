{"version":3,"sources":["..\\..\\..\\..\\..\\..\\assets\\Scripts\\Core\\Tools/assets\\Scripts\\Core\\Tools\\TouchManager.js"],"names":["openSingleTouch","cc","Node","maxTouchCount","touchCount","_dispatchEvent","prototype","dispatchEvent","event","type","canTouch","call","_onPreDestroy"],"mappings":";;;;;;AAAA;;;AAGA,IAAIA,kBAAkB,KAAtB;AACA,CAAC,YAAY;AACT,QAAI,CAACA,eAAL,EACI;AACJC,OAAGC,IAAH,CAAQC,aAAR,GAAwB,CAAxB;AACAF,OAAGC,IAAH,CAAQE,UAAR,GAAqB,CAArB;AACA,QAAIC,iBAAiBJ,GAAGC,IAAH,CAAQI,SAAR,CAAkBC,aAAvC;AACAN,OAAGC,IAAH,CAAQI,SAAR,CAAkBC,aAAlB,GAAkC,UAAUC,KAAV,EAAiB;AAC/C,gBAAQA,MAAMC,IAAd;AACI,iBAAK,YAAL;AACI,oBAAIR,GAAGC,IAAH,CAAQE,UAAR,GAAqBH,GAAGC,IAAH,CAAQC,aAAjC,EAAgD;AAC5CF,uBAAGC,IAAH,CAAQE,UAAR;AACA,yBAAKM,QAAL,GAAgB,IAAhB;AACAL,mCAAeM,IAAf,CAAoB,IAApB,EAA0BH,KAA1B;AACH;AACD;AACJ,iBAAK,WAAL;AACI,oBAAI,CAAC,KAAKE,QAAN,IAAkBT,GAAGC,IAAH,CAAQE,UAAR,GAAqBH,GAAGC,IAAH,CAAQC,aAAnD,EAAkE;AAC9D,yBAAKO,QAAL,GAAgB,IAAhB;AACAT,uBAAGC,IAAH,CAAQE,UAAR;AACH;AACD,oBAAI,KAAKM,QAAT,EAAmB;AACfL,mCAAeM,IAAf,CAAoB,IAApB,EAA0BH,KAA1B;AACH;AACD;AACJ,iBAAK,UAAL;AACI,oBAAI,KAAKE,QAAT,EAAmB;AACf,yBAAKA,QAAL,GAAgB,KAAhB;AACAT,uBAAGC,IAAH,CAAQE,UAAR;AACAH,uBAAGC,IAAH,CAAQE,UAAR,GAAqBH,GAAGC,IAAH,CAAQE,UAAR,GAAqB,CAArB,GAAyB,CAAzB,GAA6BH,GAAGC,IAAH,CAAQE,UAA1D;AACAC,mCAAeM,IAAf,CAAoB,IAApB,EAA0BH,KAA1B;AACH;AACD;AACJ,iBAAK,aAAL;AACI,oBAAI,KAAKE,QAAT,EAAmB;AACf,yBAAKA,QAAL,GAAgB,KAAhB;AACAT,uBAAGC,IAAH,CAAQE,UAAR;AACAH,uBAAGC,IAAH,CAAQE,UAAR,GAAqBH,GAAGC,IAAH,CAAQE,UAAR,GAAqB,CAArB,GAAyB,CAAzB,GAA6BH,GAAGC,IAAH,CAAQE,UAA1D;AACAC,mCAAeM,IAAf,CAAoB,IAApB,EAA0BH,KAA1B;AACH;AACD;AACJ;AACIH,+BAAeM,IAAf,CAAoB,IAApB,EAA0BH,KAA1B;AACA;AAnCR;AAqCH,KAtCD;AAuCA;;AAEA,QAAII,gBAAgBX,GAAGC,IAAH,CAAQI,SAAR,CAAkBM,aAAtC;AACAX,OAAGC,IAAH,CAAQI,SAAR,CAAkBM,aAAlB,GAAkC,YAAY;AAC1C,YAAI,KAAKF,QAAT,EAAmB;AACf,iBAAKA,QAAL,GAAgB,KAAhB;AACAT,eAAGC,IAAH,CAAQE,UAAR;AACAH,eAAGC,IAAH,CAAQE,UAAR,GAAqBH,GAAGC,IAAH,CAAQE,UAAR,GAAqB,CAArB,GAAyB,CAAzB,GAA6BH,GAAGC,IAAH,CAAQE,UAA1D;AACH;AACDQ,sBAAcD,IAAd,CAAmB,IAAnB;AACH,KAPD;AAQH,CAxDD","file":"TouchManager.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\Scripts\\Core\\Tools","sourcesContent":["/*\r\n触摸管理，用于控制多点触控问题\r\n*/\r\nlet openSingleTouch = false;\r\n(function () {\r\n    if (!openSingleTouch)\r\n        return;\r\n    cc.Node.maxTouchCount = 1;\r\n    cc.Node.touchCount = 0;\r\n    var _dispatchEvent = cc.Node.prototype.dispatchEvent;\r\n    cc.Node.prototype.dispatchEvent = function (event) {\r\n        switch (event.type) {\r\n            case 'touchstart':\r\n                if (cc.Node.touchCount < cc.Node.maxTouchCount) {\r\n                    cc.Node.touchCount++;\r\n                    this.canTouch = true;\r\n                    _dispatchEvent.call(this, event);\r\n                }\r\n                break;\r\n            case 'touchmove':\r\n                if (!this.canTouch && cc.Node.touchCount < cc.Node.maxTouchCount) {\r\n                    this.canTouch = true;\r\n                    cc.Node.touchCount++;\r\n                }\r\n                if (this.canTouch) {\r\n                    _dispatchEvent.call(this, event);\r\n                }\r\n                break;\r\n            case 'touchend':\r\n                if (this.canTouch) {\r\n                    this.canTouch = false;\r\n                    cc.Node.touchCount--;\r\n                    cc.Node.touchCount = cc.Node.touchCount < 0 ? 0 : cc.Node.touchCount;\r\n                    _dispatchEvent.call(this, event);\r\n                }\r\n                break;\r\n            case 'touchcancel':\r\n                if (this.canTouch) {\r\n                    this.canTouch = false;\r\n                    cc.Node.touchCount--;\r\n                    cc.Node.touchCount = cc.Node.touchCount < 0 ? 0 : cc.Node.touchCount;\r\n                    _dispatchEvent.call(this, event);\r\n                }\r\n                break;\r\n            default:\r\n                _dispatchEvent.call(this, event);\r\n                break;\r\n        }\r\n    }\r\n    // var onPostActivated = cc.Node.prototype._onPostActivated;\r\n\r\n    var _onPreDestroy = cc.Node.prototype._onPreDestroy;\r\n    cc.Node.prototype._onPreDestroy = function () {\r\n        if (this.canTouch) {\r\n            this.canTouch = false;\r\n            cc.Node.touchCount--;\r\n            cc.Node.touchCount = cc.Node.touchCount < 0 ? 0 : cc.Node.touchCount;\r\n        }\r\n        _onPreDestroy.call(this)\r\n    }\r\n})();"]}