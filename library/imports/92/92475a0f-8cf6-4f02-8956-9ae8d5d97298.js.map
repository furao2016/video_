{"version":3,"sources":["..\\..\\..\\..\\..\\..\\assets\\Scripts\\UI\\view_videoSys/assets\\Scripts\\UI\\view_videoSys\\lottery_videoFlow.js"],"names":["cc","_decorator","ccclass","property","lottery_videoFlow","VideoPlayer","Node","lottery_animCom","Animation","lottery_videoCom","Sprite","msgFuncDefine","msgList","totalTime","nowMsgPos","isPlayCountDown","videoArr","one","node","on","animFinshCallBack","bind","active","arr","document","getElementsByClassName","muted","style","zIndex","videoStream","opacity","setUrl","lottery_lotteryData","getInstance","videoUrl","master","HD","systemEvent","lottery_EventDefine","VIDEOFLOW","RESTART","startPlay","videosMsgFatory","ins","pause","play","console","log","unscheduleAllCallbacks","stageFinsh","obj","shift","type","data","time","expect","nestExpect","setQiShu","qiShuArr","anim","getComponent","timer","setTimeout","stop","clearTimeout","currentTime","littleCom","setData","BALLINFO","setOneBallFly","setFinshCallBack","startLottery","simulated","lottery_MsgStation","lotteryResults","index","openCode","off","balls","countDownArr","parent","setCountDown","timer1","str","isBig","removeAllChildren","split","func","url","instantiate","nodeItem","Utils","setSprite","addChild","name","minute","Math","floor","second","length","unshift","event","detail","ballNum","Component"],"mappings":"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","file":"lottery_videoFlow.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\Scripts\\UI\\view_videoSys","sourcesContent":["import videosMsgFatory from \"./videoMsgFactory\";\r\nimport Utils from \"../../Core/Tools/lottery_Utils\";\r\nimport lottery_animCom from \"../animCom/lottery_animCom\";\r\nimport lottery_lotteryData from \"../../Data/lottery_lotteryData\";\r\nimport { setInterval, clearInterval } from \"timers\";\r\nimport lottery_videoCom from \"../videoCom/lottery_videoCom\";\r\nimport { lottery_EventDefine } from \"../../Data/lottery_EventDefine\";\r\nimport lottery_MsgStation from \"../../Data/lottery_MsgStation\";\r\nconst { ccclass, property } = cc._decorator;\r\n//考虑再拆分成小类,当前写法下每一个阶段一个函数，每个函数中有大量的修改界面的代码\r\n//只有按照正确的顺序执行 才能正常的显示\r\n@ccclass\r\nexport default class lottery_videoFlow extends cc.Component {\r\n    //定义的收到消息后的方法\r\n    msgFuncDefine = ['firstStage', 'secondStage', 'thirdStage', 'fourStage', 'fiveStage', 'sixStage', 'waitStage', 'fengPan'];\r\n    @property([cc.VideoPlayer])\r\n    videoArr = []; //视频合集\r\n    @property([cc.Node])\r\n    qiShuArr = [];\r\n    @property(cc.Node)\r\n    nodeItem = null;\r\n    @property(lottery_animCom)\r\n    littleCom = null;\r\n    @property(cc.Animation)\r\n    startLottery = null;\r\n    @property([cc.Animation])\r\n    balls = [];\r\n    @property(lottery_videoCom)\r\n    videoStream = null;\r\n    @property([cc.Sprite])\r\n    countDownArr = [];\r\n\r\n    //播放队列\r\n    msgList = [];\r\n    //播放总时长秒\r\n    totalTime = 60;\r\n    //当前顺序\r\n    nowMsgPos = 0;\r\n    //是否播放倒计时\r\n    isPlayCountDown = false;\r\n    /**上一阶段的结束后执行的操作*/\r\n    stageFinsh;\r\n\r\n    start() {\r\n        for (let one of this.videoArr) {\r\n            one.node.on('completed', this.animFinshCallBack.bind(this));\r\n            one.node.active = false;\r\n        }\r\n        let arr = document.getElementsByClassName('cocosVideo');\r\n        for (let one of arr) {\r\n            one.muted = true;\r\n            one.style.zIndex = '-1';\r\n        }\r\n        this.videoStream.node.opacity = 0;\r\n        this.videoStream.setUrl(lottery_lotteryData.getInstance().videoUrl.master.HD);\r\n        cc.systemEvent.on(lottery_EventDefine.VIDEOFLOW.RESTART, this.startPlay, this);\r\n    }\r\n\r\n    /**\r\n     * 开始播放\r\n     */\r\n    startPlay() {\r\n        this.msgList = videosMsgFatory.ins().msgList;\r\n        this.animFinshCallBack();\r\n    }\r\n\r\n    /**\r\n     * 结束播放\r\n     */\r\n    stopPlay() {\r\n        this.videoStream.pause();\r\n    }\r\n    /*--------------------------------------------播放阶段设置--------------------------------------------- */\r\n    //每一阶段结束回调,这里的判断条件是单段视频播放完毕，然而存在循环播放的情况，这种写法则会重复调用\r\n    animFinshCallBack() {\r\n        if (this.isPlayCountDown) {\r\n            this.videoArr[5].play();\r\n            return;\r\n        }\r\n        console.log(\"某一阶段播放完毕\");\r\n        this.unscheduleAllCallbacks();\r\n        this.stageFinsh && this.stageFinsh();\r\n        let obj = this.msgList.shift();\r\n        if (obj) { //播放当前\r\n            this[this.msgFuncDefine[obj.type - 1]](obj.data);\r\n        } else {\r\n            console.log('消息队列空了');\r\n            //重新开始\r\n            this.startPlay();\r\n        }\r\n    }\r\n    //片头\r\n    firstStage(time) {\r\n        //设置期数\r\n        let expect = lottery_lotteryData.getInstance().expect;\r\n        let nestExpect = lottery_lotteryData.getInstance().nestExpect;\r\n        this.setQiShu(expect, this.qiShuArr[0], true);\r\n        this.setQiShu(expect, this.qiShuArr[1], false)\r\n        this.setQiShu(nestExpect, this.qiShuArr[2], true);\r\n        //\r\n        this.videoArr[0].node.active = true;\r\n        this.videoArr[0].play();\r\n\r\n        this.qiShuArr[0].active = true;\r\n        let anim = this.qiShuArr[0].getComponent(cc.Animation);\r\n        anim.play();\r\n\r\n        let timer;\r\n        if (time) {\r\n            timer = setTimeout(() => {\r\n                this.animFinshCallBack();\r\n            }, time);\r\n        }\r\n        this.stageFinsh = () => {\r\n            anim.stop();\r\n            this.qiShuArr[0].active = false;\r\n            this.videoArr[0].stop();\r\n            this.videoArr[0].node.active = false;\r\n            timer && clearTimeout(timer);\r\n        }\r\n\r\n    }\r\n    /**\r\n     * 开奖倒计时\r\n     * @param  index 从第几个开始 \r\n     */\r\n    secondStage(data = 10) {\r\n        this.videoArr[1].node.active = true;\r\n        this.videoArr[1].currentTime = data >= 10 ? -1 : 10 - data;\r\n        this.videoArr[1].play();\r\n        this.stageFinsh = () => {\r\n            this.videoArr[1].stop();\r\n            this.videoArr[1].node.active = false;\r\n        }\r\n    }\r\n    /**\r\n     * 开奖进行时 \r\n     */\r\n    thirdStage() {\r\n        this.videoStream.node.opacity = 255;\r\n        this.littleCom.node.active = true;\r\n        this.littleCom.setData('startLotteryBg');\r\n        cc.systemEvent.on(lottery_EventDefine.VIDEOFLOW.BALLINFO, this.setOneBallFly, this);\r\n        this.littleCom.setFinshCallBack(() => {\r\n            this.littleCom.setData('startLotteryBgLoop', 0, true);\r\n            this.startLottery.node.active = true\r\n            this.startLottery.play();\r\n            if (lottery_lotteryData.getInstance().simulated) {\r\n                let one = 0;\r\n                let timer = setInterval(() => {\r\n                    if (one >= 2) {\r\n                        clearInterval(timer);\r\n                    }\r\n                    lottery_MsgStation.getInstance().lotteryResults({ index: one++, openCode: 1 });\r\n                }, 2000);\r\n            }\r\n        })\r\n        this.stageFinsh = () => {\r\n            this.littleCom.node.active = false;\r\n            this.videoStream.node.opacity = 0;\r\n            cc.systemEvent.off(lottery_EventDefine.VIDEOFLOW.BALLINFO, this.setOneBallFly, this);\r\n        }\r\n    }\r\n    /**\r\n     * 播放开奖结果\r\n     */\r\n    fourStage(data) {\r\n        this.videoArr[2].node.active = true;\r\n        this.videoArr[2].play();\r\n        this.balls[0].play('ball_1');\r\n        this.balls[1].play('ball_2');\r\n        this.balls[2].play('ball_3');\r\n        this.startLottery.play('startLottery_qishu');\r\n        this.stageFinsh = () => {\r\n            for (let one of this.balls)\r\n                one.node.active = false;\r\n            this.videoArr[2].stop();\r\n            this.videoArr[2].node.active = false;\r\n            this.startLottery.node.active = false;\r\n        }\r\n    }\r\n    /**\r\n     * 播放 ebet3d logo\r\n     */\r\n    fiveStage(data) {\r\n        this.videoArr[3].node.active = true;\r\n        this.videoArr[3].play();\r\n        this.stageFinsh = () => {\r\n            this.videoArr[3].stop();\r\n            this.videoArr[3].node.active = false;\r\n        }\r\n    }\r\n    /**\r\n     * 下期预告\r\n     * @param  time 播放时间\r\n     */\r\n    sixStage(data) {\r\n        this.videoArr[4].node.active = true;\r\n        this.videoArr[4].play();\r\n        this.qiShuArr[2].active = true;\r\n        let anim = this.qiShuArr[2].getComponent(cc.Animation);\r\n        anim.play();\r\n        this.stageFinsh = () => {\r\n            anim.stop();\r\n            this.qiShuArr[2].active = false;\r\n            this.videoArr[4].stop();\r\n            this.videoArr[4].node.active = false;\r\n        }\r\n    }\r\n    /**\r\n     * 等待状态,\r\n     * time 等待时间\r\n     */\r\n    waitStage(time) {\r\n        this.isPlayCountDown = true;\r\n        this.videoArr[5].node.active = true;\r\n        this.videoArr[5].play();\r\n        this.countDownArr[0].node.parent.active = true;\r\n        this.setCountDown(time--);\r\n        let timer1 = setInterval(() => {\r\n            if (time < 0) {\r\n                clearInterval(timer1);\r\n                this.isPlayCountDown = false;\r\n                this.animFinshCallBack();\r\n            }\r\n            this.setCountDown(time--);\r\n            this.countDownArr[4].node.active = !this.countDownArr[4].node.active;\r\n        }, 1000);\r\n        this.stageFinsh = () => {\r\n            this.countDownArr[0].node.parent.active = false;\r\n            this.videoArr[5].stop();\r\n            this.videoArr[5].node.active = false;\r\n        }\r\n    }\r\n    /**封盘**/\r\n    fengPan() {\r\n        this.videoArr[6].node.active = true;\r\n        this.videoArr[6].play();\r\n        this.stageFinsh = () => {\r\n            this.videoArr[6].node.active = false;\r\n            this.videoArr[6].stop();\r\n        }\r\n    }\r\n    /*----------------------------------------------相关设置----------------------------------------------*/\r\n    /**\r\n     * 设置当前播放期数\r\n    */\r\n    setQiShu(str, node, isBig = true) {\r\n        node.removeAllChildren();\r\n        let arr = (str + '').split('');\r\n        let func = (url) => {\r\n            let one = cc.instantiate(this.nodeItem);\r\n            Utils.getInstance().setSprite(one.getComponent(cc.Sprite), url, 'LEDAtlas');\r\n            node.addChild(one);\r\n        }\r\n\r\n        if (isBig) {\r\n            for (let name of arr) {\r\n                func('wz_sz_' + name);\r\n            }\r\n            func('wz_qi');\r\n        } else {\r\n            for (let name of arr) {\r\n                func('wz_xsz_' + name);\r\n            }\r\n            func('wz_qi_2');\r\n        }\r\n    }\r\n    /**\r\n     * 设置倒计时,最小单位是秒\r\n     */\r\n    setCountDown(time = 60) {\r\n        let minute = Math.floor(time / 60);\r\n        let second = time - minute * 60;\r\n        minute = (minute + '').split('');\r\n        second = (second + '').split('');\r\n        if (minute.length == 1) minute.unshift(0);\r\n        if (second.length == 1) second.unshift(0);\r\n        Utils.getInstance().setSprite(this.countDownArr[0], minute[0], 'countDown');\r\n        Utils.getInstance().setSprite(this.countDownArr[1], minute[1], 'countDown');\r\n        Utils.getInstance().setSprite(this.countDownArr[2], second[0], 'countDown');\r\n        Utils.getInstance().setSprite(this.countDownArr[3], second[1], 'countDown');\r\n    }\r\n    /**设置单个球的飞入*/\r\n    //球的坐标\r\n    setOneBallFly(event) {\r\n        let index = event.detail.index;\r\n        let ballNum = event.detail.openCode;\r\n        Utils.getInstance().setSprite(this.balls[index].getComponent(cc.Sprite), 'cq_' + ballNum, 'LEDAtlas');\r\n        this.balls[index].node.active = true;\r\n        this.balls[index].play();\r\n        if (index == 2) {\r\n            console.log(\"最后一颗球\");\r\n            setTimeout(() => {\r\n                this.animFinshCallBack();\r\n            }, 2000);\r\n\r\n        }\r\n    }\r\n}"]}