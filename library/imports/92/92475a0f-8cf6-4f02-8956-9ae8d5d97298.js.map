{"version":3,"sources":["..\\..\\..\\..\\..\\..\\assets\\Scripts\\UI\\view_videoSys/assets\\Scripts\\UI\\view_videoSys\\lottery_videoFlow.js"],"names":["cc","_decorator","ccclass","property","lottery_videoFlow","VideoPlayer","Node","lottery_animCom","Animation","lottery_videoCom","Sprite","msgFuncDefine","msgList","totalTime","nowMsgPos","isPlayCountDown","videoArr","one","node","on","animFinshCallBack","bind","active","arr","document","getElementsByClassName","muted","style","zIndex","videoStream","opacity","init","systemEvent","lottery_EventDefine","VIDEOFLOW","RESTART","startPlay","videosMsgFatory","ins","pause","play","console","log","unscheduleAllCallbacks","stageFinsh","obj","shift","type","data","time","lotteryId","lottery_lotteryData","getInstance","setQiShu","qiShuArr","anim","getComponent","timer","setTimeout","stop","clearTimeout","currentTime","littleCom","setData","BALLINFO","setOneBallFly","setFinshCallBack","startLottery","period","lottery_MsgStation","lotteryResults","index","ballNum","off","balls","countDownArr","parent","setCountDown","timer1","str","isBig","removeAllChildren","split","func","url","instantiate","nodeItem","Utils","setSprite","addChild","name","minute","Math","floor","second","length","unshift","event","detail","Component"],"mappings":";;;;;;;;;;;;;;;AAAA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;AACA;;;;AACA;;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;qBAC8BA,GAAGC;IAAzBC,yBAAAA;IAASC,0BAAAA;AACjB;AACA;;IAEqBC,4BAGhBD,SAAS,CAACH,GAAGK,WAAJ,CAAT,WAEAF,SAAS,CAACH,GAAGM,IAAJ,CAAT,WAEAH,SAASH,GAAGM,IAAZ,WAEAH,SAASI,yBAAT,WAEAJ,SAASH,GAAGQ,SAAZ,WAEAL,SAAS,CAACH,GAAGQ,SAAJ,CAAT,WAEAL,SAASM,0BAAT,WAEAN,SAAS,CAACH,GAAGU,MAAJ,CAAT,GAlBJR;;;;;;;;;;;;;;gNAGGS,gBAAgB,CAAC,YAAD,EAAe,aAAf,EAA8B,YAA9B,EAA4C,WAA5C,EAAyD,WAAzD,EAAsE,UAAtE,EAAkF,WAAlF,ydAmBhBC,UAAU,UAEVC,YAAY,UAEZC,YAAY,SAEZC,kBAAkB;;AA1BlB;AAGe;;;AAgBf;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;;;;gCAGQ;AAAA;AAAA;AAAA;;AAAA;AACJ,qCAAgB,KAAKC,QAArB,8HAA+B;AAAA,wBAAtBC,GAAsB;;AAC3BA,wBAAIC,IAAJ,CAASC,EAAT,CAAY,WAAZ,EAAyB,KAAKC,iBAAL,CAAuBC,IAAvB,CAA4B,IAA5B,CAAzB;AACAJ,wBAAIC,IAAJ,CAASI,MAAT,GAAkB,KAAlB;AACH;AAJG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAKJ,gBAAIC,MAAMC,SAASC,sBAAT,CAAgC,YAAhC,CAAV;AALI;AAAA;AAAA;;AAAA;AAMJ,sCAAgBF,GAAhB,mIAAqB;AAAA,wBAAZN,IAAY;;AACjBA,yBAAIS,KAAJ,GAAY,IAAZ;AACAT,yBAAIU,KAAJ,CAAUC,MAAV,GAAmB,IAAnB;AACH;AATG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAUJ,iBAAKC,WAAL,CAAiBX,IAAjB,CAAsBY,OAAtB,GAAgC,CAAhC;AACA,iBAAKD,WAAL,CAAiBE,IAAjB,CAAsB,IAAtB,EAA4B,IAA5B;AACA/B,eAAGgC,WAAH,CAAeb,EAAf,CAAkBc,yCAAoBC,SAApB,CAA8BC,OAAhD,EAAyD,KAAKC,SAA9D,EAAyE,IAAzE;AACH;;AAED;;;;;;oCAGY;AACR,iBAAKxB,OAAL,GAAeyB,0BAAgBC,GAAhB,GAAsB1B,OAArC;AACA,iBAAKQ,iBAAL;AACH;;AAED;;;;;;mCAGW;AACP,iBAAKS,WAAL,CAAiBU,KAAjB;AACH;AACD;AACA;;;;4CACoB;AAChB,gBAAI,KAAKxB,eAAT,EAA0B;AACtB,qBAAKC,QAAL,CAAc,CAAd,EAAiBwB,IAAjB;AACA;AACH;AACDC,oBAAQC,GAAR,CAAY,UAAZ;AACA,iBAAKC,sBAAL;AACA,iBAAKC,UAAL,IAAmB,KAAKA,UAAL,EAAnB;AACA,gBAAIC,MAAM,KAAKjC,OAAL,CAAakC,KAAb,EAAV;AACA,gBAAID,GAAJ,EAAS;AAAE;AACP,qBAAK,KAAKlC,aAAL,CAAmBkC,IAAIE,IAAJ,GAAW,CAA9B,CAAL,EAAuCF,IAAIG,IAA3C;AACH,aAFD,MAEO;AACHP,wBAAQC,GAAR,CAAY,QAAZ;AACA;AACA,qBAAKN,SAAL;AACH;AACJ;AACD;;;;mCACWa,MAAM;AAAA;;AACb;AACA,iBAAKC,SAAL,GAAiBC,8BAAoBC,WAApB,GAAkCF,SAAlC,EAAjB;AACA,iBAAKG,QAAL,CAAc,KAAKH,SAAnB,EAA8B,KAAKI,QAAL,CAAc,CAAd,CAA9B,EAAgD,IAAhD;AACA,iBAAKD,QAAL,CAAc,KAAKH,SAAnB,EAA8B,KAAKI,QAAL,CAAc,CAAd,CAA9B,EAAgD,KAAhD;AACA,iBAAKD,QAAL,CAAc,KAAKH,SAAL,GAAiB,CAA/B,EAAkC,KAAKI,QAAL,CAAc,CAAd,CAAlC,EAAoD,IAApD;AACA;AACA,iBAAKtC,QAAL,CAAc,CAAd,EAAiBE,IAAjB,CAAsBI,MAAtB,GAA+B,IAA/B;AACA,iBAAKN,QAAL,CAAc,CAAd,EAAiBwB,IAAjB;;AAEA,iBAAKc,QAAL,CAAc,CAAd,EAAiBhC,MAAjB,GAA0B,IAA1B;AACA,gBAAIiC,OAAO,KAAKD,QAAL,CAAc,CAAd,EAAiBE,YAAjB,CAA8BxD,GAAGQ,SAAjC,CAAX;AACA+C,iBAAKf,IAAL;;AAEA,gBAAIiB,cAAJ;AACA,gBAAIR,IAAJ,EAAU;AACNQ,wBAAQC,WAAW,YAAM;AACrB,2BAAKtC,iBAAL;AACH,iBAFO,EAEL6B,IAFK,CAAR;AAGH;AACD,iBAAKL,UAAL,GAAkB,YAAM;AACpBW,qBAAKI,IAAL;AACA,uBAAKL,QAAL,CAAc,CAAd,EAAiBhC,MAAjB,GAA0B,KAA1B;AACA,uBAAKN,QAAL,CAAc,CAAd,EAAiB2C,IAAjB;AACA,uBAAK3C,QAAL,CAAc,CAAd,EAAiBE,IAAjB,CAAsBI,MAAtB,GAA+B,KAA/B;AACAmC,yBAASG,aAAaH,KAAb,CAAT;AACH,aAND;AAQH;AACD;;;;;;;sCAIuB;AAAA;;AAAA,gBAAXT,IAAW,uEAAJ,EAAI;;AACnB,iBAAKhC,QAAL,CAAc,CAAd,EAAiBE,IAAjB,CAAsBI,MAAtB,GAA+B,IAA/B;AACA,iBAAKN,QAAL,CAAc,CAAd,EAAiB6C,WAAjB,GAA+Bb,QAAQ,EAAR,GAAa,CAAC,CAAd,GAAkB,KAAKA,IAAtD;AACA,iBAAKhC,QAAL,CAAc,CAAd,EAAiBwB,IAAjB;AACA,iBAAKI,UAAL,GAAkB,YAAM;AACpB,uBAAK5B,QAAL,CAAc,CAAd,EAAiB2C,IAAjB;AACA,uBAAK3C,QAAL,CAAc,CAAd,EAAiBE,IAAjB,CAAsBI,MAAtB,GAA+B,KAA/B;AACH,aAHD;AAIH;AACD;;;;;;qCAGa;AAAA;;AACT,iBAAKO,WAAL,CAAiBX,IAAjB,CAAsBY,OAAtB,GAAgC,GAAhC;AACA,iBAAKgC,SAAL,CAAe5C,IAAf,CAAoBI,MAApB,GAA6B,IAA7B;AACA,iBAAKwC,SAAL,CAAeC,OAAf,CAAuB,gBAAvB;AACA/D,eAAGgC,WAAH,CAAeb,EAAf,CAAkBc,yCAAoBC,SAApB,CAA8B8B,QAAhD,EAA0D,KAAKC,aAA/D,EAA8E,IAA9E;AACA,iBAAKH,SAAL,CAAeI,gBAAf,CAAgC,YAAM;AAClC,uBAAKJ,SAAL,CAAeC,OAAf,CAAuB,oBAAvB,EAA6C,CAA7C,EAAgD,IAAhD;AACA,uBAAKI,YAAL,CAAkBjD,IAAlB,CAAuBI,MAAvB,GAAgC,IAAhC;AACA,uBAAK6C,YAAL,CAAkB3B,IAAlB;AACA,oBAAIH,0BAAgBC,GAAhB,GAAsB8B,MAAtB,IAAgC,CAApC,EAAuC;AACnC,wBAAInD,MAAM,CAAV;AACA,wBAAIwC,QAAQ,yBAAY,YAAM;AAC1B,4BAAIxC,OAAO,CAAX,EAAc;AACV,uDAAcwC,KAAd;AACH;AACDY,qDAAmBjB,WAAnB,GAAiCkB,cAAjC,CAAgD,EAAEC,OAAOtD,KAAT,EAAgBuD,SAAS,CAAzB,EAAhD;AACH,qBALW,EAKT,IALS,CAAZ;AAMH;AACJ,aAbD;AAcA,iBAAK5B,UAAL,GAAkB,YAAM;AACpB,uBAAKkB,SAAL,CAAe5C,IAAf,CAAoBI,MAApB,GAA6B,KAA7B;AACA,uBAAKO,WAAL,CAAiBX,IAAjB,CAAsBY,OAAtB,GAAgC,CAAhC;AACA9B,mBAAGgC,WAAH,CAAeyC,GAAf,CAAmBxC,yCAAoBC,SAApB,CAA8B8B,QAAjD,EAA2D,OAAKC,aAAhE;AACH,aAJD;AAKH;AACD;;;;;;kCAGUjB,MAAM;AAAA;;AACZ,iBAAKhC,QAAL,CAAc,CAAd,EAAiBE,IAAjB,CAAsBI,MAAtB,GAA+B,IAA/B;AACA,iBAAKN,QAAL,CAAc,CAAd,EAAiBwB,IAAjB;AACA,iBAAKkC,KAAL,CAAW,CAAX,EAAclC,IAAd,CAAmB,QAAnB;AACA,iBAAKkC,KAAL,CAAW,CAAX,EAAclC,IAAd,CAAmB,QAAnB;AACA,iBAAKkC,KAAL,CAAW,CAAX,EAAclC,IAAd,CAAmB,QAAnB;AACA,iBAAK2B,YAAL,CAAkB3B,IAAlB,CAAuB,oBAAvB;AACA,iBAAKI,UAAL,GAAkB,YAAM;AAAA;AAAA;AAAA;;AAAA;AACpB,0CAAgB,OAAK8B,KAArB;AAAA,4BAASzD,GAAT;;AACIA,4BAAIC,IAAJ,CAASI,MAAT,GAAkB,KAAlB;AADJ;AADoB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAGpB,uBAAKN,QAAL,CAAc,CAAd,EAAiB2C,IAAjB;AACA,uBAAK3C,QAAL,CAAc,CAAd,EAAiBE,IAAjB,CAAsBI,MAAtB,GAA+B,KAA/B;AACA,uBAAK6C,YAAL,CAAkBjD,IAAlB,CAAuBI,MAAvB,GAAgC,KAAhC;AACH,aAND;AAOH;AACD;;;;;;kCAGU0B,MAAM;AAAA;;AACZ,iBAAKhC,QAAL,CAAc,CAAd,EAAiBE,IAAjB,CAAsBI,MAAtB,GAA+B,IAA/B;AACA,iBAAKN,QAAL,CAAc,CAAd,EAAiBwB,IAAjB;AACA,iBAAKI,UAAL,GAAkB,YAAM;AACpB,uBAAK5B,QAAL,CAAc,CAAd,EAAiB2C,IAAjB;AACA,uBAAK3C,QAAL,CAAc,CAAd,EAAiBE,IAAjB,CAAsBI,MAAtB,GAA+B,KAA/B;AACH,aAHD;AAIH;AACD;;;;;;;iCAIS0B,MAAM;AAAA;;AACX,iBAAKhC,QAAL,CAAc,CAAd,EAAiBE,IAAjB,CAAsBI,MAAtB,GAA+B,IAA/B;AACA,iBAAKN,QAAL,CAAc,CAAd,EAAiBwB,IAAjB;AACA,iBAAKc,QAAL,CAAc,CAAd,EAAiBhC,MAAjB,GAA0B,IAA1B;AACA,gBAAIiC,OAAO,KAAKD,QAAL,CAAc,CAAd,EAAiBE,YAAjB,CAA8BxD,GAAGQ,SAAjC,CAAX;AACA+C,iBAAKf,IAAL;AACA,iBAAKI,UAAL,GAAkB,YAAM;AACpBW,qBAAKI,IAAL;AACA,uBAAKL,QAAL,CAAc,CAAd,EAAiBhC,MAAjB,GAA0B,KAA1B;AACA,uBAAKN,QAAL,CAAc,CAAd,EAAiB2C,IAAjB;AACA,uBAAK3C,QAAL,CAAc,CAAd,EAAiBE,IAAjB,CAAsBI,MAAtB,GAA+B,KAA/B;AACH,aALD;AAMH;AACD;;;;;;;kCAIU2B,MAAM;AAAA;;AACZ,iBAAKlC,eAAL,GAAuB,IAAvB;AACA,iBAAKC,QAAL,CAAc,CAAd,EAAiBE,IAAjB,CAAsBI,MAAtB,GAA+B,IAA/B;AACA,iBAAKN,QAAL,CAAc,CAAd,EAAiBwB,IAAjB;AACA,iBAAKmC,YAAL,CAAkB,CAAlB,EAAqBzD,IAArB,CAA0B0D,MAA1B,CAAiCtD,MAAjC,GAA0C,IAA1C;AACA,iBAAKuD,YAAL,CAAkB5B,MAAlB;AACA,gBAAI6B,SAAS,yBAAY,YAAM;AAC3B,oBAAI7B,OAAO,CAAX,EAAc;AACV,+CAAc6B,MAAd;AACA,2BAAK/D,eAAL,GAAuB,KAAvB;AACA,2BAAKK,iBAAL;AACH;AACD,uBAAKyD,YAAL,CAAkB5B,MAAlB;AACA,uBAAK0B,YAAL,CAAkB,CAAlB,EAAqBzD,IAArB,CAA0BI,MAA1B,GAAmC,CAAC,OAAKqD,YAAL,CAAkB,CAAlB,EAAqBzD,IAArB,CAA0BI,MAA9D;AACH,aARY,EAQV,IARU,CAAb;AASA,iBAAKsB,UAAL,GAAkB,YAAM;AACpB,uBAAK+B,YAAL,CAAkB,CAAlB,EAAqBzD,IAArB,CAA0B0D,MAA1B,CAAiCtD,MAAjC,GAA0C,KAA1C;AACA,uBAAKN,QAAL,CAAc,CAAd,EAAiB2C,IAAjB;AACA,uBAAK3C,QAAL,CAAc,CAAd,EAAiBE,IAAjB,CAAsBI,MAAtB,GAA+B,KAA/B;AACH,aAJD;AAKH;AACD;AACA;;;;;;iCAGSyD,KAAK7D,MAAoB;AAAA;;AAAA,gBAAd8D,KAAc,uEAAN,IAAM;;AAC9B9D,iBAAK+D,iBAAL;AACA,gBAAI1D,MAAM,CAACwD,MAAM,EAAP,EAAWG,KAAX,CAAiB,EAAjB,CAAV;AACA,gBAAIC,OAAO,SAAPA,IAAO,CAACC,GAAD,EAAS;AAChB,oBAAInE,MAAMjB,GAAGqF,WAAH,CAAe,OAAKC,QAApB,CAAV;AACAC,wCAAMnC,WAAN,GAAoBoC,SAApB,CAA8BvE,IAAIuC,YAAJ,CAAiBxD,GAAGU,MAApB,CAA9B,EAA2D0E,GAA3D,EAAgE,UAAhE;AACAlE,qBAAKuE,QAAL,CAAcxE,GAAd;AACH,aAJD;;AAMA,gBAAI+D,KAAJ,EAAW;AAAA;AAAA;AAAA;;AAAA;AACP,0CAAiBzD,GAAjB,mIAAsB;AAAA,4BAAbmE,IAAa;;AAClBP,6BAAK,WAAWO,IAAhB;AACH;AAHM;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAIPP,qBAAK,OAAL;AACH,aALD,MAKO;AAAA;AAAA;AAAA;;AAAA;AACH,0CAAiB5D,GAAjB,mIAAsB;AAAA,4BAAbmE,KAAa;;AAClBP,6BAAK,YAAYO,KAAjB;AACH;AAHE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAIHP,qBAAK,SAAL;AACH;AACJ;AACD;;;;;;uCAGwB;AAAA,gBAAXlC,IAAW,uEAAJ,EAAI;;AACpB,gBAAI0C,SAASC,KAAKC,KAAL,CAAW5C,OAAO,EAAlB,CAAb;AACA,gBAAI6C,SAAS7C,OAAO0C,SAAS,EAA7B;AACAA,qBAAS,CAACA,SAAS,EAAV,EAAcT,KAAd,CAAoB,EAApB,CAAT;AACAY,qBAAS,CAACA,SAAS,EAAV,EAAcZ,KAAd,CAAoB,EAApB,CAAT;AACA,gBAAIS,OAAOI,MAAP,IAAiB,CAArB,EAAwBJ,OAAOK,OAAP,CAAe,CAAf;AACxB,gBAAIF,OAAOC,MAAP,IAAiB,CAArB,EAAwBD,OAAOE,OAAP,CAAe,CAAf;AACxBT,oCAAMnC,WAAN,GAAoBoC,SAApB,CAA8B,KAAKb,YAAL,CAAkB,CAAlB,CAA9B,EAAoDgB,OAAO,CAAP,CAApD,EAA+D,WAA/D;AACAJ,oCAAMnC,WAAN,GAAoBoC,SAApB,CAA8B,KAAKb,YAAL,CAAkB,CAAlB,CAA9B,EAAoDgB,OAAO,CAAP,CAApD,EAA+D,WAA/D;AACAJ,oCAAMnC,WAAN,GAAoBoC,SAApB,CAA8B,KAAKb,YAAL,CAAkB,CAAlB,CAA9B,EAAoDmB,OAAO,CAAP,CAApD,EAA+D,WAA/D;AACAP,oCAAMnC,WAAN,GAAoBoC,SAApB,CAA8B,KAAKb,YAAL,CAAkB,CAAlB,CAA9B,EAAoDmB,OAAO,CAAP,CAApD,EAA+D,WAA/D;AACH;AACD;AACA;;;;sCACcG,OAAO;AAAA;;AACjB,gBAAI1B,QAAQ0B,MAAMC,MAAN,CAAa3B,KAAzB;AACA,gBAAIC,UAAUyB,MAAMC,MAAN,CAAa1B,OAA3B;AACAe,oCAAMnC,WAAN,GAAoBoC,SAApB,CAA8B,KAAKd,KAAL,CAAWH,KAAX,EAAkBf,YAAlB,CAA+BxD,GAAGU,MAAlC,CAA9B,EAAyE,QAAQ8D,OAAjF,EAA0F,UAA1F;AACA,iBAAKE,KAAL,CAAWH,KAAX,EAAkBrD,IAAlB,CAAuBI,MAAvB,GAAgC,IAAhC;AACA,iBAAKoD,KAAL,CAAWH,KAAX,EAAkB/B,IAAlB;AACA,gBAAI+B,SAAS,CAAb,EAAgB;AACZ9B,wBAAQC,GAAR,CAAY,OAAZ;AACAgB,2BAAW,YAAM;AACb,4BAAKtC,iBAAL;AACH,iBAFD,EAEG,IAFH;AAIH;AACJ;;;;EAtR0CpB,GAAGmG;;;eAInC;;;;;eAEA;;;;;eAEA;;;;;eAEC;;;;;eAEG;;;;;eAEP;;;;;eAEM;;;;;eAEC;;;kBAlBE/F","file":"lottery_videoFlow.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\Scripts\\UI\\view_videoSys","sourcesContent":["import videosMsgFatory from \"./videoMsgFactory\";\r\nimport Utils from \"../../Core/Tools/lottery_Utils\";\r\nimport lottery_animCom from \"../animCom/lottery_animCom\";\r\nimport lottery_lotteryData from \"../../Data/lottery_lotteryData\";\r\nimport { setInterval, clearInterval } from \"timers\";\r\nimport lottery_videoCom from \"../videoCom/lottery_videoCom\";\r\nimport { lottery_EventDefine } from \"../../Data/lottery_EventDefine\";\r\nimport lottery_MsgStation from \"./Data/lottery_MsgStation\";\r\nconst { ccclass, property } = cc._decorator;\r\n//考虑再拆分成小类,当前写法下每一个阶段一个函数，每个函数中有大量的修改界面的代码\r\n//只有按照正确的顺序执行 才能正常的显示\r\n@ccclass\r\nexport default class lottery_videoFlow extends cc.Component {\r\n    //定义的收到消息后的方法\r\n    msgFuncDefine = ['firstStage', 'secondStage', 'thirdStage', 'fourStage', 'fiveStage', 'sixStage', 'waitStage'];\r\n    @property([cc.VideoPlayer])\r\n    videoArr = []; //视频合集\r\n    @property([cc.Node])\r\n    qiShuArr = [];\r\n    @property(cc.Node)\r\n    nodeItem = null;\r\n    @property(lottery_animCom)\r\n    littleCom = null;\r\n    @property(cc.Animation)\r\n    startLottery = null;\r\n    @property([cc.Animation])\r\n    balls = [];\r\n    @property(lottery_videoCom)\r\n    videoStream = null;\r\n    @property([cc.Sprite])\r\n    countDownArr = [];\r\n\r\n    //播放队列\r\n    msgList = [];\r\n    //播放总时长秒\r\n    totalTime = 60;\r\n    //当前顺序\r\n    nowMsgPos = 0;\r\n    //是否播放倒计时\r\n    isPlayCountDown = false;\r\n    //获取当前期数\r\n    lotteryId;\r\n    /**上一阶段的结束后执行的操作*/\r\n    stageFinsh;\r\n\r\n    start() {\r\n        for (let one of this.videoArr) {\r\n            one.node.on('completed', this.animFinshCallBack.bind(this));\r\n            one.node.active = false;\r\n        }\r\n        let arr = document.getElementsByClassName('cocosVideo');\r\n        for (let one of arr) {\r\n            one.muted = true;\r\n            one.style.zIndex = '-1';\r\n        }\r\n        this.videoStream.node.opacity = 0;\r\n        this.videoStream.init(null, true);\r\n        cc.systemEvent.on(lottery_EventDefine.VIDEOFLOW.RESTART, this.startPlay, this);\r\n    }\r\n\r\n    /**\r\n     * 开始播放\r\n     */\r\n    startPlay() {\r\n        this.msgList = videosMsgFatory.ins().msgList;\r\n        this.animFinshCallBack();\r\n    }\r\n\r\n    /**\r\n     * 结束播放\r\n     */\r\n    stopPlay() {\r\n        this.videoStream.pause();\r\n    }\r\n    /*--------------------------------------------播放阶段设置--------------------------------------------- */\r\n    //每一阶段结束回调,这里的判断条件是单段视频播放完毕，然而存在循环播放的情况，这种写法则会重复调用\r\n    animFinshCallBack() {\r\n        if (this.isPlayCountDown) {\r\n            this.videoArr[5].play();\r\n            return;\r\n        }\r\n        console.log(\"某一阶段播放完毕\");\r\n        this.unscheduleAllCallbacks();\r\n        this.stageFinsh && this.stageFinsh();\r\n        let obj = this.msgList.shift();\r\n        if (obj) { //播放当前\r\n            this[this.msgFuncDefine[obj.type - 1]](obj.data);\r\n        } else {\r\n            console.log('消息队列空了');\r\n            //重新开始\r\n            this.startPlay();\r\n        }\r\n    }\r\n    //片头\r\n    firstStage(time) {\r\n        //设置期数\r\n        this.lotteryId = lottery_lotteryData.getInstance().lotteryId++;\r\n        this.setQiShu(this.lotteryId, this.qiShuArr[0], true);\r\n        this.setQiShu(this.lotteryId, this.qiShuArr[1], false)\r\n        this.setQiShu(this.lotteryId + 1, this.qiShuArr[2], true);\r\n        //\r\n        this.videoArr[0].node.active = true;\r\n        this.videoArr[0].play();\r\n\r\n        this.qiShuArr[0].active = true;\r\n        let anim = this.qiShuArr[0].getComponent(cc.Animation);\r\n        anim.play();\r\n\r\n        let timer;\r\n        if (time) {\r\n            timer = setTimeout(() => {\r\n                this.animFinshCallBack();\r\n            }, time);\r\n        }\r\n        this.stageFinsh = () => {\r\n            anim.stop();\r\n            this.qiShuArr[0].active = false;\r\n            this.videoArr[0].stop();\r\n            this.videoArr[0].node.active = false;\r\n            timer && clearTimeout(timer);\r\n        }\r\n\r\n    }\r\n    /**\r\n     * 开奖倒计时\r\n     * @param  index 从第几个开始 \r\n     */\r\n    secondStage(data = 10) {\r\n        this.videoArr[1].node.active = true;\r\n        this.videoArr[1].currentTime = data >= 10 ? -1 : 10 - data;\r\n        this.videoArr[1].play();\r\n        this.stageFinsh = () => {\r\n            this.videoArr[1].stop();\r\n            this.videoArr[1].node.active = false;\r\n        }\r\n    }\r\n    /**\r\n     * 开奖进行时 \r\n     */\r\n    thirdStage() {\r\n        this.videoStream.node.opacity = 255;\r\n        this.littleCom.node.active = true;\r\n        this.littleCom.setData('startLotteryBg');\r\n        cc.systemEvent.on(lottery_EventDefine.VIDEOFLOW.BALLINFO, this.setOneBallFly, this);\r\n        this.littleCom.setFinshCallBack(() => {\r\n            this.littleCom.setData('startLotteryBgLoop', 0, true);\r\n            this.startLottery.node.active = true\r\n            this.startLottery.play();\r\n            if (videosMsgFatory.ins().period == 0) {\r\n                let one = 0;\r\n                let timer = setInterval(() => {\r\n                    if (one >= 2) {\r\n                        clearInterval(timer);\r\n                    }\r\n                    lottery_MsgStation.getInstance().lotteryResults({ index: one++, ballNum: 1 });\r\n                }, 2000);\r\n            }\r\n        })\r\n        this.stageFinsh = () => {\r\n            this.littleCom.node.active = false;\r\n            this.videoStream.node.opacity = 0;\r\n            cc.systemEvent.off(lottery_EventDefine.VIDEOFLOW.BALLINFO, this.setOneBallFly, this);\r\n        }\r\n    }\r\n    /**\r\n     * 播放开奖结果\r\n     */\r\n    fourStage(data) {\r\n        this.videoArr[2].node.active = true;\r\n        this.videoArr[2].play();\r\n        this.balls[0].play('ball_1');\r\n        this.balls[1].play('ball_2');\r\n        this.balls[2].play('ball_3');\r\n        this.startLottery.play('startLottery_qishu');\r\n        this.stageFinsh = () => {\r\n            for (let one of this.balls)\r\n                one.node.active = false;\r\n            this.videoArr[2].stop();\r\n            this.videoArr[2].node.active = false;\r\n            this.startLottery.node.active = false;\r\n        }\r\n    }\r\n    /**\r\n     * 播放 ebet3d logo\r\n     */\r\n    fiveStage(data) {\r\n        this.videoArr[3].node.active = true;\r\n        this.videoArr[3].play();\r\n        this.stageFinsh = () => {\r\n            this.videoArr[3].stop();\r\n            this.videoArr[3].node.active = false;\r\n        }\r\n    }\r\n    /**\r\n     * 下期预告\r\n     * @param  time 播放时间\r\n     */\r\n    sixStage(data) {\r\n        this.videoArr[4].node.active = true;\r\n        this.videoArr[4].play();\r\n        this.qiShuArr[2].active = true;\r\n        let anim = this.qiShuArr[2].getComponent(cc.Animation);\r\n        anim.play();\r\n        this.stageFinsh = () => {\r\n            anim.stop();\r\n            this.qiShuArr[2].active = false;\r\n            this.videoArr[4].stop();\r\n            this.videoArr[4].node.active = false;\r\n        }\r\n    }\r\n    /**\r\n     * 等待状态,\r\n     * time 等待时间\r\n     */\r\n    waitStage(time) {\r\n        this.isPlayCountDown = true;\r\n        this.videoArr[5].node.active = true;\r\n        this.videoArr[5].play();\r\n        this.countDownArr[0].node.parent.active = true;\r\n        this.setCountDown(time--);\r\n        let timer1 = setInterval(() => {\r\n            if (time < 0) {\r\n                clearInterval(timer1);\r\n                this.isPlayCountDown = false;\r\n                this.animFinshCallBack();\r\n            }\r\n            this.setCountDown(time--);\r\n            this.countDownArr[4].node.active = !this.countDownArr[4].node.active;\r\n        }, 1000);\r\n        this.stageFinsh = () => {\r\n            this.countDownArr[0].node.parent.active = false;\r\n            this.videoArr[5].stop();\r\n            this.videoArr[5].node.active = false;\r\n        }\r\n    }\r\n    /*----------------------------------------------相关设置----------------------------------------------*/\r\n    /**\r\n     * 设置当前播放期数\r\n    */\r\n    setQiShu(str, node, isBig = true) {\r\n        node.removeAllChildren();\r\n        let arr = (str + '').split('');\r\n        let func = (url) => {\r\n            let one = cc.instantiate(this.nodeItem);\r\n            Utils.getInstance().setSprite(one.getComponent(cc.Sprite), url, 'LEDAtlas');\r\n            node.addChild(one);\r\n        }\r\n\r\n        if (isBig) {\r\n            for (let name of arr) {\r\n                func('wz_sz_' + name);\r\n            }\r\n            func('wz_qi');\r\n        } else {\r\n            for (let name of arr) {\r\n                func('wz_xsz_' + name);\r\n            }\r\n            func('wz_qi_2');\r\n        }\r\n    }\r\n    /**\r\n     * 设置倒计时,最小单位是秒\r\n     */\r\n    setCountDown(time = 60) {\r\n        let minute = Math.floor(time / 60);\r\n        let second = time - minute * 60;\r\n        minute = (minute + '').split('');\r\n        second = (second + '').split('');\r\n        if (minute.length == 1) minute.unshift(0);\r\n        if (second.length == 1) second.unshift(0);\r\n        Utils.getInstance().setSprite(this.countDownArr[0], minute[0], 'countDown');\r\n        Utils.getInstance().setSprite(this.countDownArr[1], minute[1], 'countDown');\r\n        Utils.getInstance().setSprite(this.countDownArr[2], second[0], 'countDown');\r\n        Utils.getInstance().setSprite(this.countDownArr[3], second[1], 'countDown');\r\n    }\r\n    /**设置单个球的飞入*/\r\n    //球的坐标\r\n    setOneBallFly(event) {\r\n        let index = event.detail.index;\r\n        let ballNum = event.detail.ballNum;\r\n        Utils.getInstance().setSprite(this.balls[index].getComponent(cc.Sprite), 'cq_' + ballNum, 'LEDAtlas');\r\n        this.balls[index].node.active = true;\r\n        this.balls[index].play();\r\n        if (index == 2) {\r\n            console.log(\"最后一颗球\");\r\n            setTimeout(() => {\r\n                this.animFinshCallBack();\r\n            }, 2000);\r\n\r\n        }\r\n    }\r\n}"]}